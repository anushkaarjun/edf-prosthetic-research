/Users/anushkaarjun/synopsys/edf-prosthetic-research/src/edf_ml_model/preprocessing.py:289: RuntimeWarning: All epochs were dropped!
You might need to alter reject/flat-criteria or drop bad channels to avoid this. You can use Epochs.plot_drop_log() to see which channels are responsible for the dropping of epochs.
  epochs = mne.Epochs(
/Users/anushkaarjun/synopsys/edf-prosthetic-research/src/edf_ml_model/preprocessing.py:289: RuntimeWarning: All epochs were dropped!
You might need to alter reject/flat-criteria or drop bad channels to avoid this. You can use Epochs.plot_drop_log() to see which channels are responsible for the dropping of epochs.
  epochs = mne.Epochs(
/Users/anushkaarjun/synopsys/edf-prosthetic-research/src/edf_ml_model/preprocessing.py:289: RuntimeWarning: All epochs were dropped!
You might need to alter reject/flat-criteria or drop bad channels to avoid this. You can use Epochs.plot_drop_log() to see which channels are responsible for the dropping of epochs.
  epochs = mne.Epochs(
/Users/anushkaarjun/synopsys/edf-prosthetic-research/src/edf_ml_model/preprocessing.py:289: RuntimeWarning: All epochs were dropped!
You might need to alter reject/flat-criteria or drop bad channels to avoid this. You can use Epochs.plot_drop_log() to see which channels are responsible for the dropping of epochs.
  epochs = mne.Epochs(
/Users/anushkaarjun/synopsys/edf-prosthetic-research/src/edf_ml_model/preprocessing.py:289: RuntimeWarning: All epochs were dropped!
You might need to alter reject/flat-criteria or drop bad channels to avoid this. You can use Epochs.plot_drop_log() to see which channels are responsible for the dropping of epochs.
  epochs = mne.Epochs(
/Users/anushkaarjun/synopsys/edf-prosthetic-research/src/edf_ml_model/preprocessing.py:289: RuntimeWarning: All epochs were dropped!
You might need to alter reject/flat-criteria or drop bad channels to avoid this. You can use Epochs.plot_drop_log() to see which channels are responsible for the dropping of epochs.
  epochs = mne.Epochs(
/Users/anushkaarjun/synopsys/edf-prosthetic-research/src/edf_ml_model/preprocessing.py:289: RuntimeWarning: All epochs were dropped!
You might need to alter reject/flat-criteria or drop bad channels to avoid this. You can use Epochs.plot_drop_log() to see which channels are responsible for the dropping of epochs.
  epochs = mne.Epochs(
/Users/anushkaarjun/synopsys/edf-prosthetic-research/src/edf_ml_model/preprocessing.py:289: RuntimeWarning: All epochs were dropped!
You might need to alter reject/flat-criteria or drop bad channels to avoid this. You can use Epochs.plot_drop_log() to see which channels are responsible for the dropping of epochs.
  epochs = mne.Epochs(
/Users/anushkaarjun/synopsys/edf-prosthetic-research/src/edf_ml_model/preprocessing.py:289: RuntimeWarning: All epochs were dropped!
You might need to alter reject/flat-criteria or drop bad channels to avoid this. You can use Epochs.plot_drop_log() to see which channels are responsible for the dropping of epochs.
  epochs = mne.Epochs(
/Users/anushkaarjun/synopsys/edf-prosthetic-research/src/edf_ml_model/preprocessing.py:289: RuntimeWarning: All epochs were dropped!
You might need to alter reject/flat-criteria or drop bad channels to avoid this. You can use Epochs.plot_drop_log() to see which channels are responsible for the dropping of epochs.
  epochs = mne.Epochs(
Loading data from 5 subjects...
  Error processing /Users/anushkaarjun/Desktop/Outside of School/Prosethic Research Data/files 2/S001/S001R01.edf: epochs.Modifying data of epochs() can't run because this Epochs-object is empty. You might want to check Epochs.drop_log or Epochs.plot_drop_log() to see why epochs were dropped.
  Error processing /Users/anushkaarjun/Desktop/Outside of School/Prosethic Research Data/files 2/S001/S001R02.edf: epochs.Modifying data of epochs() can't run because this Epochs-object is empty. You might want to check Epochs.drop_log or Epochs.plot_drop_log() to see why epochs were dropped.
  Subject S001: 348 epochs, shape (348, 64, 126)
    Normalized range: [-1.0000, 1.0000] (target: [-1, 1])
  Error processing /Users/anushkaarjun/Desktop/Outside of School/Prosethic Research Data/files 2/S002/S002R01.edf: epochs.Modifying data of epochs() can't run because this Epochs-object is empty. You might want to check Epochs.drop_log or Epochs.plot_drop_log() to see why epochs were dropped.
  Error processing /Users/anushkaarjun/Desktop/Outside of School/Prosethic Research Data/files 2/S002/S002R02.edf: epochs.Modifying data of epochs() can't run because this Epochs-object is empty. You might want to check Epochs.drop_log or Epochs.plot_drop_log() to see why epochs were dropped.
  Subject S002: 348 epochs, shape (348, 64, 126)
    Normalized range: [-1.0000, 1.0000] (target: [-1, 1])
  Error processing /Users/anushkaarjun/Desktop/Outside of School/Prosethic Research Data/files 2/S003/S003R01.edf: epochs.Modifying data of epochs() can't run because this Epochs-object is empty. You might want to check Epochs.drop_log or Epochs.plot_drop_log() to see why epochs were dropped.
  Error processing /Users/anushkaarjun/Desktop/Outside of School/Prosethic Research Data/files 2/S003/S003R02.edf: epochs.Modifying data of epochs() can't run because this Epochs-object is empty. You might want to check Epochs.drop_log or Epochs.plot_drop_log() to see why epochs were dropped.
  Subject S003: 348 epochs, shape (348, 64, 126)
    Normalized range: [-1.0000, 1.0000] (target: [-1, 1])
  Error processing /Users/anushkaarjun/Desktop/Outside of School/Prosethic Research Data/files 2/S004/S004R01.edf: epochs.Modifying data of epochs() can't run because this Epochs-object is empty. You might want to check Epochs.drop_log or Epochs.plot_drop_log() to see why epochs were dropped.
  Error processing /Users/anushkaarjun/Desktop/Outside of School/Prosethic Research Data/files 2/S004/S004R02.edf: epochs.Modifying data of epochs() can't run because this Epochs-object is empty. You might want to check Epochs.drop_log or Epochs.plot_drop_log() to see why epochs were dropped.
  Subject S004: 348 epochs, shape (348, 64, 126)
    Normalized range: [-1.0000, 1.0000] (target: [-1, 1])
  Error processing /Users/anushkaarjun/Desktop/Outside of School/Prosethic Research Data/files 2/S005/S005R01.edf: epochs.Modifying data of epochs() can't run because this Epochs-object is empty. You might want to check Epochs.drop_log or Epochs.plot_drop_log() to see why epochs were dropped.
  Error processing /Users/anushkaarjun/Desktop/Outside of School/Prosethic Research Data/files 2/S005/S005R02.edf: epochs.Modifying data of epochs() can't run because this Epochs-object is empty. You might want to check Epochs.drop_log or Epochs.plot_drop_log() to see why epochs were dropped.
  Subject S005: 348 epochs, shape (348, 64, 126)
    Normalized range: [-1.0000, 1.0000] (target: [-1, 1])

Using device: cpu

==================================================
Training model for Subject S001
==================================================
Data shape: (348, 64, 126), Classes: ['Both Feet', 'Both Fists', 'Left Hand', 'Right Hand']
Class distribution:
  Both Feet: 90 (25.9%)
  Both Fists: 84 (24.1%)
  Left Hand: 84 (24.1%)
  Right Hand: 90 (25.9%)
Train: 222, Validation: 56, Test: 70

Phase 1: Training all weights (epochs 1-30)...
Epoch [10/30], Loss: 5.8297, Val Acc: 0.4107
Epoch [20/30], Loss: 1.0566, Val Acc: 0.3750
Epoch [30/30], Loss: 0.2438, Val Acc: 0.3750

Phase 2: Freezing backbone weights...
  Backbone layers frozen. Only classifier will be trained.

Phase 3: Tuning hyperparameters on validation set...
  Testing hyperparameter combinations on validation set...
    [1/16] LR=0.0001, WD=0e+00, Val Acc: 0.3750
    [2/16] LR=0.0001, WD=1e-05, Val Acc: 0.3929
    [3/16] LR=0.0001, WD=1e-04, Val Acc: 0.3929
    [4/16] LR=0.0001, WD=1e-03, Val Acc: 0.4107
    [5/16] LR=0.0005, WD=0e+00, Val Acc: 0.3929
    [6/16] LR=0.0005, WD=1e-05, Val Acc: 0.3929
    [7/16] LR=0.0005, WD=1e-04, Val Acc: 0.3750
    [8/16] LR=0.0005, WD=1e-03, Val Acc: 0.3750
    [9/16] LR=0.0010, WD=0e+00, Val Acc: 0.4107
    [10/16] LR=0.0010, WD=1e-05, Val Acc: 0.4107
    [11/16] LR=0.0010, WD=1e-04, Val Acc: 0.3929
    [12/16] LR=0.0010, WD=1e-03, Val Acc: 0.4286
    [13/16] LR=0.0050, WD=0e+00, Val Acc: 0.4286
    [14/16] LR=0.0050, WD=1e-05, Val Acc: 0.4286
    [15/16] LR=0.0050, WD=1e-04, Val Acc: 0.4286
    [16/16] LR=0.0050, WD=1e-03, Val Acc: 0.4107
  Best validation accuracy during tuning: 0.4286 (42.86%)

Phase 4: Fine-tuning classifier with best hyperparameters (epochs 31-50)...
  Best hyperparameters: {'lr': 0.001, 'weight_decay': 0.001}
  Epoch [10/20], Loss: 0.0371, Val Acc: 0.4107
  Epoch [20/20], Loss: 0.0294, Val Acc: 0.3929

Subject S001 Results:
  Validation Accuracy: 0.3929 (39.29%)
  Final Test Accuracy: 0.5000 (50.00%)

==================================================
Training model for Subject S002
==================================================
Data shape: (348, 64, 126), Classes: ['Both Feet', 'Both Fists', 'Left Hand', 'Right Hand']
Class distribution:
  Both Feet: 90 (25.9%)
  Both Fists: 84 (24.1%)
  Left Hand: 84 (24.1%)
  Right Hand: 90 (25.9%)
Train: 222, Validation: 56, Test: 70

Phase 1: Training all weights (epochs 1-30)...
Epoch [10/30], Loss: 3.8868, Val Acc: 0.4821
Epoch [20/30], Loss: 0.5751, Val Acc: 0.4286
Epoch [30/30], Loss: 0.2412, Val Acc: 0.4286

Phase 2: Freezing backbone weights...
  Backbone layers frozen. Only classifier will be trained.

Phase 3: Tuning hyperparameters on validation set...
  Testing hyperparameter combinations on validation set...
    [1/16] LR=0.0001, WD=0e+00, Val Acc: 0.4643
    [2/16] LR=0.0001, WD=1e-05, Val Acc: 0.4643
    [3/16] LR=0.0001, WD=1e-04, Val Acc: 0.4464
    [4/16] LR=0.0001, WD=1e-03, Val Acc: 0.4643
    [5/16] LR=0.0005, WD=0e+00, Val Acc: 0.4464
    [6/16] LR=0.0005, WD=1e-05, Val Acc: 0.4643
    [7/16] LR=0.0005, WD=1e-04, Val Acc: 0.4643
    [8/16] LR=0.0005, WD=1e-03, Val Acc: 0.4464
    [9/16] LR=0.0010, WD=0e+00, Val Acc: 0.5000
    [10/16] LR=0.0010, WD=1e-05, Val Acc: 0.4821
    [11/16] LR=0.0010, WD=1e-04, Val Acc: 0.4821
    [12/16] LR=0.0010, WD=1e-03, Val Acc: 0.4643
    [13/16] LR=0.0050, WD=0e+00, Val Acc: 0.4643
    [14/16] LR=0.0050, WD=1e-05, Val Acc: 0.4464
    [15/16] LR=0.0050, WD=1e-04, Val Acc: 0.4643
    [16/16] LR=0.0050, WD=1e-03, Val Acc: 0.5000
  Best validation accuracy during tuning: 0.5000 (50.00%)

Phase 4: Fine-tuning classifier with best hyperparameters (epochs 31-50)...
  Best hyperparameters: {'lr': 0.001, 'weight_decay': 0.0}
  Epoch [10/20], Loss: 0.2139, Val Acc: 0.5000
  Epoch [20/20], Loss: 0.0447, Val Acc: 0.5000

Subject S002 Results:
  Validation Accuracy: 0.5000 (50.00%)
  Final Test Accuracy: 0.5000 (50.00%)

==================================================
Training model for Subject S003
==================================================
Data shape: (348, 64, 126), Classes: ['Both Feet', 'Both Fists', 'Left Hand', 'Right Hand']
Class distribution:
  Both Feet: 90 (25.9%)
  Both Fists: 84 (24.1%)
  Left Hand: 84 (24.1%)
  Right Hand: 90 (25.9%)
Train: 222, Validation: 56, Test: 70

Phase 1: Training all weights (epochs 1-30)...
Epoch [10/30], Loss: 5.7792, Val Acc: 0.3571
Epoch [20/30], Loss: 0.8863, Val Acc: 0.4464
Epoch [30/30], Loss: 0.1812, Val Acc: 0.3036

Phase 2: Freezing backbone weights...
  Backbone layers frozen. Only classifier will be trained.

Phase 3: Tuning hyperparameters on validation set...
  Testing hyperparameter combinations on validation set...
    [1/16] LR=0.0001, WD=0e+00, Val Acc: 0.4643
    [2/16] LR=0.0001, WD=1e-05, Val Acc: 0.4643
    [3/16] LR=0.0001, WD=1e-04, Val Acc: 0.4643
    [4/16] LR=0.0001, WD=1e-03, Val Acc: 0.4464
    [5/16] LR=0.0005, WD=0e+00, Val Acc: 0.4643
    [6/16] LR=0.0005, WD=1e-05, Val Acc: 0.4643
    [7/16] LR=0.0005, WD=1e-04, Val Acc: 0.4643
    [8/16] LR=0.0005, WD=1e-03, Val Acc: 0.4643
    [9/16] LR=0.0010, WD=0e+00, Val Acc: 0.4464
    [10/16] LR=0.0010, WD=1e-05, Val Acc: 0.4464
    [11/16] LR=0.0010, WD=1e-04, Val Acc: 0.4821
    [12/16] LR=0.0010, WD=1e-03, Val Acc: 0.4464
    [13/16] LR=0.0050, WD=0e+00, Val Acc: 0.4286
    [14/16] LR=0.0050, WD=1e-05, Val Acc: 0.4107
    [15/16] LR=0.0050, WD=1e-04, Val Acc: 0.4643
    [16/16] LR=0.0050, WD=1e-03, Val Acc: 0.4464
  Best validation accuracy during tuning: 0.4821 (48.21%)

Phase 4: Fine-tuning classifier with best hyperparameters (epochs 31-50)...
  Best hyperparameters: {'lr': 0.001, 'weight_decay': 0.0001}
  Epoch [10/20], Loss: 0.0261, Val Acc: 0.4821
  Epoch [20/20], Loss: 0.0289, Val Acc: 0.5000

Subject S003 Results:
  Validation Accuracy: 0.5000 (50.00%)
  Final Test Accuracy: 0.4143 (41.43%)

==================================================
Training model for Subject S004
==================================================
Data shape: (348, 64, 126), Classes: ['Both Feet', 'Both Fists', 'Left Hand', 'Right Hand']
Class distribution:
  Both Feet: 90 (25.9%)
  Both Fists: 84 (24.1%)
  Left Hand: 84 (24.1%)
  Right Hand: 90 (25.9%)
Train: 222, Validation: 56, Test: 70

Phase 1: Training all weights (epochs 1-30)...
Epoch [10/30], Loss: 4.4470, Val Acc: 0.3750
Epoch [20/30], Loss: 0.6465, Val Acc: 0.2679
Epoch [30/30], Loss: 0.0673, Val Acc: 0.4821

Phase 2: Freezing backbone weights...
  Backbone layers frozen. Only classifier will be trained.

Phase 3: Tuning hyperparameters on validation set...
  Testing hyperparameter combinations on validation set...
    [1/16] LR=0.0001, WD=0e+00, Val Acc: 0.6071
    [2/16] LR=0.0001, WD=1e-05, Val Acc: 0.6071
    [3/16] LR=0.0001, WD=1e-04, Val Acc: 0.6071
    [4/16] LR=0.0001, WD=1e-03, Val Acc: 0.6071
    [5/16] LR=0.0005, WD=0e+00, Val Acc: 0.6071
    [6/16] LR=0.0005, WD=1e-05, Val Acc: 0.6071
    [7/16] LR=0.0005, WD=1e-04, Val Acc: 0.6071
    [8/16] LR=0.0005, WD=1e-03, Val Acc: 0.6071
    [9/16] LR=0.0010, WD=0e+00, Val Acc: 0.6071
    [10/16] LR=0.0010, WD=1e-05, Val Acc: 0.6071
    [11/16] LR=0.0010, WD=1e-04, Val Acc: 0.6071
    [12/16] LR=0.0010, WD=1e-03, Val Acc: 0.6071
    [13/16] LR=0.0050, WD=0e+00, Val Acc: 0.5893
    [14/16] LR=0.0050, WD=1e-05, Val Acc: 0.5893
    [15/16] LR=0.0050, WD=1e-04, Val Acc: 0.5893
    [16/16] LR=0.0050, WD=1e-03, Val Acc: 0.6250
  Best validation accuracy during tuning: 0.6250 (62.50%)

Phase 4: Fine-tuning classifier with best hyperparameters (epochs 31-50)...
  Best hyperparameters: {'lr': 0.005, 'weight_decay': 0.001}
  Epoch [10/20], Loss: 0.0058, Val Acc: 0.5893
  Epoch [20/20], Loss: 0.0077, Val Acc: 0.6071

Subject S004 Results:
  Validation Accuracy: 0.6071 (60.71%)
  Final Test Accuracy: 0.4857 (48.57%)

==================================================
Training model for Subject S005
==================================================
Data shape: (348, 64, 126), Classes: ['Both Feet', 'Both Fists', 'Left Hand', 'Right Hand']
Class distribution:
  Both Feet: 90 (25.9%)
  Both Fists: 84 (24.1%)
  Left Hand: 84 (24.1%)
  Right Hand: 90 (25.9%)
Train: 222, Validation: 56, Test: 70

Phase 1: Training all weights (epochs 1-30)...
Epoch [10/30], Loss: 2.1377, Val Acc: 0.2857
Epoch [20/30], Loss: 0.1039, Val Acc: 0.2857
Epoch [30/30], Loss: 0.0325, Val Acc: 0.3036

Phase 2: Freezing backbone weights...
  Backbone layers frozen. Only classifier will be trained.

Phase 3: Tuning hyperparameters on validation set...
  Testing hyperparameter combinations on validation set...
    [1/16] LR=0.0001, WD=0e+00, Val Acc: 0.3036
    [2/16] LR=0.0001, WD=1e-05, Val Acc: 0.3036
    [3/16] LR=0.0001, WD=1e-04, Val Acc: 0.3036
    [4/16] LR=0.0001, WD=1e-03, Val Acc: 0.3036
    [5/16] LR=0.0005, WD=0e+00, Val Acc: 0.3036
    [6/16] LR=0.0005, WD=1e-05, Val Acc: 0.3036
    [7/16] LR=0.0005, WD=1e-04, Val Acc: 0.2857
    [8/16] LR=0.0005, WD=1e-03, Val Acc: 0.3036
    [9/16] LR=0.0010, WD=0e+00, Val Acc: 0.3036
    [10/16] LR=0.0010, WD=1e-05, Val Acc: 0.3036
    [11/16] LR=0.0010, WD=1e-04, Val Acc: 0.3036
    [12/16] LR=0.0010, WD=1e-03, Val Acc: 0.3036
    [13/16] LR=0.0050, WD=0e+00, Val Acc: 0.3036
    [14/16] LR=0.0050, WD=1e-05, Val Acc: 0.2857
    [15/16] LR=0.0050, WD=1e-04, Val Acc: 0.3214
    [16/16] LR=0.0050, WD=1e-03, Val Acc: 0.2857
  Best validation accuracy during tuning: 0.3214 (32.14%)

Phase 4: Fine-tuning classifier with best hyperparameters (epochs 31-50)...
  Best hyperparameters: {'lr': 0.005, 'weight_decay': 0.0001}
  Epoch [10/20], Loss: 0.0002, Val Acc: 0.3036
  Epoch [20/20], Loss: 0.0031, Val Acc: 0.3214

Subject S005 Results:
  Validation Accuracy: 0.3214 (32.14%)
  Final Test Accuracy: 0.4000 (40.00%)

==================================================
OVERALL RESULTS
==================================================
Average Validation Accuracy: 0.4643 (46.43%)
Average Test Accuracy: 0.4600 (46.00%)

âš  Below target (80%). Current test accuracy: 46.00%
