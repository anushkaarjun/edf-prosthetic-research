/Users/anushkaarjun/synopsys/edf-prosthetic-research/run_eegnet.py:155: RuntimeWarning: All epochs were dropped!
You might need to alter reject/flat-criteria or drop bad channels to avoid this. You can use Epochs.plot_drop_log() to see which channels are responsible for the dropping of epochs.
  epochs = mne.Epochs(
/Users/anushkaarjun/synopsys/edf-prosthetic-research/run_eegnet.py:155: RuntimeWarning: All epochs were dropped!
You might need to alter reject/flat-criteria or drop bad channels to avoid this. You can use Epochs.plot_drop_log() to see which channels are responsible for the dropping of epochs.
  epochs = mne.Epochs(
/Users/anushkaarjun/synopsys/edf-prosthetic-research/run_eegnet.py:155: RuntimeWarning: All epochs were dropped!
You might need to alter reject/flat-criteria or drop bad channels to avoid this. You can use Epochs.plot_drop_log() to see which channels are responsible for the dropping of epochs.
  epochs = mne.Epochs(
/Users/anushkaarjun/synopsys/edf-prosthetic-research/run_eegnet.py:155: RuntimeWarning: All epochs were dropped!
You might need to alter reject/flat-criteria or drop bad channels to avoid this. You can use Epochs.plot_drop_log() to see which channels are responsible for the dropping of epochs.
  epochs = mne.Epochs(
/Users/anushkaarjun/synopsys/edf-prosthetic-research/run_eegnet.py:155: RuntimeWarning: All epochs were dropped!
You might need to alter reject/flat-criteria or drop bad channels to avoid this. You can use Epochs.plot_drop_log() to see which channels are responsible for the dropping of epochs.
  epochs = mne.Epochs(
/Users/anushkaarjun/synopsys/edf-prosthetic-research/run_eegnet.py:155: RuntimeWarning: All epochs were dropped!
You might need to alter reject/flat-criteria or drop bad channels to avoid this. You can use Epochs.plot_drop_log() to see which channels are responsible for the dropping of epochs.
  epochs = mne.Epochs(
/Users/anushkaarjun/synopsys/edf-prosthetic-research/run_eegnet.py:155: RuntimeWarning: All epochs were dropped!
You might need to alter reject/flat-criteria or drop bad channels to avoid this. You can use Epochs.plot_drop_log() to see which channels are responsible for the dropping of epochs.
  epochs = mne.Epochs(
/Users/anushkaarjun/synopsys/edf-prosthetic-research/run_eegnet.py:155: RuntimeWarning: All epochs were dropped!
You might need to alter reject/flat-criteria or drop bad channels to avoid this. You can use Epochs.plot_drop_log() to see which channels are responsible for the dropping of epochs.
  epochs = mne.Epochs(
/Users/anushkaarjun/synopsys/edf-prosthetic-research/run_eegnet.py:155: RuntimeWarning: All epochs were dropped!
You might need to alter reject/flat-criteria or drop bad channels to avoid this. You can use Epochs.plot_drop_log() to see which channels are responsible for the dropping of epochs.
  epochs = mne.Epochs(
/Users/anushkaarjun/synopsys/edf-prosthetic-research/run_eegnet.py:155: RuntimeWarning: All epochs were dropped!
You might need to alter reject/flat-criteria or drop bad channels to avoid this. You can use Epochs.plot_drop_log() to see which channels are responsible for the dropping of epochs.
  epochs = mne.Epochs(
/Library/Frameworks/Python.framework/Versions/3.13/lib/python3.13/site-packages/sklearn/metrics/_classification.py:1833: UndefinedMetricWarning: Precision is ill-defined and being set to 0.0 in labels with no predicted samples. Use `zero_division` parameter to control this behavior.
  _warn_prf(average, modifier, f"{metric.capitalize()} is", result.shape[0])
/Library/Frameworks/Python.framework/Versions/3.13/lib/python3.13/site-packages/sklearn/metrics/_classification.py:1833: UndefinedMetricWarning: Precision is ill-defined and being set to 0.0 in labels with no predicted samples. Use `zero_division` parameter to control this behavior.
  _warn_prf(average, modifier, f"{metric.capitalize()} is", result.shape[0])
/Library/Frameworks/Python.framework/Versions/3.13/lib/python3.13/site-packages/sklearn/metrics/_classification.py:1833: UndefinedMetricWarning: Precision is ill-defined and being set to 0.0 in labels with no predicted samples. Use `zero_division` parameter to control this behavior.
  _warn_prf(average, modifier, f"{metric.capitalize()} is", result.shape[0])
/Library/Frameworks/Python.framework/Versions/3.13/lib/python3.13/site-packages/sklearn/metrics/_classification.py:1833: UndefinedMetricWarning: Precision is ill-defined and being set to 0.0 in labels with no predicted samples. Use `zero_division` parameter to control this behavior.
  _warn_prf(average, modifier, f"{metric.capitalize()} is", result.shape[0])
/Library/Frameworks/Python.framework/Versions/3.13/lib/python3.13/site-packages/sklearn/metrics/_classification.py:1833: UndefinedMetricWarning: Precision is ill-defined and being set to 0.0 in labels with no predicted samples. Use `zero_division` parameter to control this behavior.
  _warn_prf(average, modifier, f"{metric.capitalize()} is", result.shape[0])
/Library/Frameworks/Python.framework/Versions/3.13/lib/python3.13/site-packages/sklearn/metrics/_classification.py:1833: UndefinedMetricWarning: Precision is ill-defined and being set to 0.0 in labels with no predicted samples. Use `zero_division` parameter to control this behavior.
  _warn_prf(average, modifier, f"{metric.capitalize()} is", result.shape[0])
/Library/Frameworks/Python.framework/Versions/3.13/lib/python3.13/site-packages/sklearn/metrics/_classification.py:1833: UndefinedMetricWarning: Precision is ill-defined and being set to 0.0 in labels with no predicted samples. Use `zero_division` parameter to control this behavior.
  _warn_prf(average, modifier, f"{metric.capitalize()} is", result.shape[0])
/Library/Frameworks/Python.framework/Versions/3.13/lib/python3.13/site-packages/sklearn/metrics/_classification.py:1833: UndefinedMetricWarning: Precision is ill-defined and being set to 0.0 in labels with no predicted samples. Use `zero_division` parameter to control this behavior.
  _warn_prf(average, modifier, f"{metric.capitalize()} is", result.shape[0])
/Library/Frameworks/Python.framework/Versions/3.13/lib/python3.13/site-packages/sklearn/metrics/_classification.py:1833: UndefinedMetricWarning: Precision is ill-defined and being set to 0.0 in labels with no predicted samples. Use `zero_division` parameter to control this behavior.
  _warn_prf(average, modifier, f"{metric.capitalize()} is", result.shape[0])
/Library/Frameworks/Python.framework/Versions/3.13/lib/python3.13/site-packages/sklearn/metrics/_classification.py:1833: UndefinedMetricWarning: Precision is ill-defined and being set to 0.0 in labels with no predicted samples. Use `zero_division` parameter to control this behavior.
  _warn_prf(average, modifier, f"{metric.capitalize()} is", result.shape[0])
/Library/Frameworks/Python.framework/Versions/3.13/lib/python3.13/site-packages/sklearn/metrics/_classification.py:1833: UndefinedMetricWarning: Precision is ill-defined and being set to 0.0 in labels with no predicted samples. Use `zero_division` parameter to control this behavior.
  _warn_prf(average, modifier, f"{metric.capitalize()} is", result.shape[0])
/Library/Frameworks/Python.framework/Versions/3.13/lib/python3.13/site-packages/sklearn/metrics/_classification.py:1833: UndefinedMetricWarning: Precision is ill-defined and being set to 0.0 in labels with no predicted samples. Use `zero_division` parameter to control this behavior.
  _warn_prf(average, modifier, f"{metric.capitalize()} is", result.shape[0])
/Library/Frameworks/Python.framework/Versions/3.13/lib/python3.13/site-packages/sklearn/metrics/_classification.py:1833: UndefinedMetricWarning: Precision is ill-defined and being set to 0.0 in labels with no predicted samples. Use `zero_division` parameter to control this behavior.
  _warn_prf(average, modifier, f"{metric.capitalize()} is", result.shape[0])
/Library/Frameworks/Python.framework/Versions/3.13/lib/python3.13/site-packages/sklearn/metrics/_classification.py:1833: UndefinedMetricWarning: Precision is ill-defined and being set to 0.0 in labels with no predicted samples. Use `zero_division` parameter to control this behavior.
  _warn_prf(average, modifier, f"{metric.capitalize()} is", result.shape[0])
/Library/Frameworks/Python.framework/Versions/3.13/lib/python3.13/site-packages/sklearn/metrics/_classification.py:1833: UndefinedMetricWarning: Precision is ill-defined and being set to 0.0 in labels with no predicted samples. Use `zero_division` parameter to control this behavior.
  _warn_prf(average, modifier, f"{metric.capitalize()} is", result.shape[0])
Using data path: /Users/anushkaarjun/Desktop/Outside of School/Prosethic Research Data/files 2
Processing up to 5 subjects
Using device: cpu
Using 5 subjects: ['S001', 'S002', 'S003', 'S004', 'S005']

=== Processing Subject S001 ===
  Error processing S001R01.edf: epochs.Modifying data of epochs() can't run because this Epochs-object is empty. You might want to check Epochs.drop_log or Epochs.plot_drop_log() to see why epochs were dropped.
  Error processing S001R02.edf: epochs.Modifying data of epochs() can't run because this Epochs-object is empty. You might want to check Epochs.drop_log or Epochs.plot_drop_log() to see why epochs were dropped.
  Processed 348 epochs, shape (348, 64, 126)

=== Processing Subject S002 ===
  Error processing S002R01.edf: epochs.Modifying data of epochs() can't run because this Epochs-object is empty. You might want to check Epochs.drop_log or Epochs.plot_drop_log() to see why epochs were dropped.
  Error processing S002R02.edf: epochs.Modifying data of epochs() can't run because this Epochs-object is empty. You might want to check Epochs.drop_log or Epochs.plot_drop_log() to see why epochs were dropped.
  Processed 348 epochs, shape (348, 64, 126)

=== Processing Subject S003 ===
  Error processing S003R01.edf: epochs.Modifying data of epochs() can't run because this Epochs-object is empty. You might want to check Epochs.drop_log or Epochs.plot_drop_log() to see why epochs were dropped.
  Error processing S003R02.edf: epochs.Modifying data of epochs() can't run because this Epochs-object is empty. You might want to check Epochs.drop_log or Epochs.plot_drop_log() to see why epochs were dropped.
  Processed 348 epochs, shape (348, 64, 126)

=== Processing Subject S004 ===
  Error processing S004R01.edf: epochs.Modifying data of epochs() can't run because this Epochs-object is empty. You might want to check Epochs.drop_log or Epochs.plot_drop_log() to see why epochs were dropped.
  Error processing S004R02.edf: epochs.Modifying data of epochs() can't run because this Epochs-object is empty. You might want to check Epochs.drop_log or Epochs.plot_drop_log() to see why epochs were dropped.
  Processed 348 epochs, shape (348, 64, 126)

=== Processing Subject S005 ===
  Error processing S005R01.edf: epochs.Modifying data of epochs() can't run because this Epochs-object is empty. You might want to check Epochs.drop_log or Epochs.plot_drop_log() to see why epochs were dropped.
  Error processing S005R02.edf: epochs.Modifying data of epochs() can't run because this Epochs-object is empty. You might want to check Epochs.drop_log or Epochs.plot_drop_log() to see why epochs were dropped.
  Processed 348 epochs, shape (348, 64, 126)

==================================================
Training EEGNet for Subject S001
==================================================
Data shape: (348, 64, 126), Classes: ['Both Feet', 'Both Fists', 'Left Hand', 'Right Hand']
Class distribution:
  Both Feet: 90 (25.9%)
  Both Fists: 84 (24.1%)
  Left Hand: 84 (24.1%)
  Right Hand: 90 (25.9%)
Train: 222, Val: 56, Test: 70
Model parameters: n_classes=4, n_channels=64, n_samples=126
Training with early stopping...
Epoch [10/150], Loss: 1.3641, Train Acc: 32.43%, Val Acc: 25.00%
Epoch [20/150], Loss: 1.3572, Train Acc: 35.59%, Val Acc: 28.57%
Epoch [30/150], Loss: 1.3270, Train Acc: 38.29%, Val Acc: 26.79%
Early stopping at epoch 31 (no improvement for 15 epochs)
Loaded best model with validation accuracy: 28.57%

Subject S001 Results:
  Best Validation Accuracy: 0.2857 (28.57%)
  Test Accuracy: 0.2143 (21.43%)

==================================================
Training EEGNet for Subject S002
==================================================
Data shape: (348, 64, 126), Classes: ['Both Feet', 'Both Fists', 'Left Hand', 'Right Hand']
Class distribution:
  Both Feet: 90 (25.9%)
  Both Fists: 84 (24.1%)
  Left Hand: 84 (24.1%)
  Right Hand: 90 (25.9%)
Train: 222, Val: 56, Test: 70
Model parameters: n_classes=4, n_channels=64, n_samples=126
Training with early stopping...
Epoch [10/150], Loss: 1.3461, Train Acc: 36.94%, Val Acc: 23.21%
Epoch [20/150], Loss: 1.3159, Train Acc: 38.74%, Val Acc: 23.21%
Early stopping at epoch 23 (no improvement for 15 epochs)
Loaded best model with validation accuracy: 28.57%

Subject S002 Results:
  Best Validation Accuracy: 0.2857 (28.57%)
  Test Accuracy: 0.2429 (24.29%)

==================================================
Training EEGNet for Subject S003
==================================================
Data shape: (348, 64, 126), Classes: ['Both Feet', 'Both Fists', 'Left Hand', 'Right Hand']
Class distribution:
  Both Feet: 90 (25.9%)
  Both Fists: 84 (24.1%)
  Left Hand: 84 (24.1%)
  Right Hand: 90 (25.9%)
Train: 222, Val: 56, Test: 70
Model parameters: n_classes=4, n_channels=64, n_samples=126
Training with early stopping...
Epoch [10/150], Loss: 1.3579, Train Acc: 29.28%, Val Acc: 23.21%
Early stopping at epoch 16 (no improvement for 15 epochs)
Loaded best model with validation accuracy: 26.79%

Subject S003 Results:
  Best Validation Accuracy: 0.2679 (26.79%)
  Test Accuracy: 0.3000 (30.00%)

==================================================
Training EEGNet for Subject S004
==================================================
Data shape: (348, 64, 126), Classes: ['Both Feet', 'Both Fists', 'Left Hand', 'Right Hand']
Class distribution:
  Both Feet: 90 (25.9%)
  Both Fists: 84 (24.1%)
  Left Hand: 84 (24.1%)
  Right Hand: 90 (25.9%)
Train: 222, Val: 56, Test: 70
Model parameters: n_classes=4, n_channels=64, n_samples=126
Training with early stopping...
Epoch [10/150], Loss: 1.3360, Train Acc: 40.99%, Val Acc: 25.00%
Early stopping at epoch 16 (no improvement for 15 epochs)
Loaded best model with validation accuracy: 26.79%

Subject S004 Results:
  Best Validation Accuracy: 0.2679 (26.79%)
  Test Accuracy: 0.2571 (25.71%)

==================================================
Training EEGNet for Subject S005
==================================================
Data shape: (348, 64, 126), Classes: ['Both Feet', 'Both Fists', 'Left Hand', 'Right Hand']
Class distribution:
  Both Feet: 90 (25.9%)
  Both Fists: 84 (24.1%)
  Left Hand: 84 (24.1%)
  Right Hand: 90 (25.9%)
Train: 222, Val: 56, Test: 70
Model parameters: n_classes=4, n_channels=64, n_samples=126
Training with early stopping...
Epoch [10/150], Loss: 1.3567, Train Acc: 34.23%, Val Acc: 23.21%
Early stopping at epoch 16 (no improvement for 15 epochs)
Loaded best model with validation accuracy: 23.21%

Subject S005 Results:
  Best Validation Accuracy: 0.2321 (23.21%)
  Test Accuracy: 0.2429 (24.29%)

==================================================
OVERALL RESULTS
==================================================
Average Validation Accuracy: 0.2679 (26.79%)
Average Test Accuracy: 0.2514 (25.14%)

âš  Below target (80%). Current: 25.14%

==================================================
PER-SUBJECT DETAILS
==================================================

Subject S001: Test Accuracy = 21.43%
              precision    recall  f1-score   support

   Both Feet      0.238     0.278     0.256        18
  Both Fists      0.204     0.588     0.303        17
   Left Hand      0.000     0.000     0.000        17
  Right Hand      0.000     0.000     0.000        18

    accuracy                          0.214        70
   macro avg      0.111     0.217     0.140        70
weighted avg      0.111     0.214     0.140        70


Subject S002: Test Accuracy = 24.29%
              precision    recall  f1-score   support

   Both Feet      0.000     0.000     0.000        18
  Both Fists      0.243     1.000     0.391        17
   Left Hand      0.000     0.000     0.000        17
  Right Hand      0.000     0.000     0.000        18

    accuracy                          0.243        70
   macro avg      0.061     0.250     0.098        70
weighted avg      0.059     0.243     0.095        70


Subject S003: Test Accuracy = 30.00%
              precision    recall  f1-score   support

   Both Feet      0.000     0.000     0.000        18
  Both Fists      0.455     0.294     0.357        17
   Left Hand      0.000     0.000     0.000        17
  Right Hand      0.271     0.889     0.416        18

    accuracy                          0.300        70
   macro avg      0.181     0.296     0.193        70
weighted avg      0.180     0.300     0.194        70


Subject S004: Test Accuracy = 25.71%
              precision    recall  f1-score   support

   Both Feet      0.000     0.000     0.000        18
  Both Fists      0.000     0.000     0.000        17
   Left Hand      0.000     0.000     0.000        17
  Right Hand      0.257     1.000     0.409        18

    accuracy                          0.257        70
   macro avg      0.064     0.250     0.102        70
weighted avg      0.066     0.257     0.105        70


Subject S005: Test Accuracy = 24.29%
              precision    recall  f1-score   support

   Both Feet      0.000     0.000     0.000        18
  Both Fists      0.243     1.000     0.391        17
   Left Hand      0.000     0.000     0.000        17
  Right Hand      0.000     0.000     0.000        18

    accuracy                          0.243        70
   macro avg      0.061     0.250     0.098        70
weighted avg      0.059     0.243     0.095        70


============================================================
FINAL RESULT: Average Test Accuracy = 25.14%
============================================================
